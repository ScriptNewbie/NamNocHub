(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{256:function(e,t,n){"use strict";n.d(t,"a",(function(){return Dt}));var r=n(8),a=n(79),i=n(420),o=n(419),c=n(26),s=n(213),u=n(18),l=n.n(u),d=n(4),b=n(72),j=n(3),p=n(0),f=n(52),O=n(89),y=n(140),g=n(417),h=n(421),m=n(121),x=n(257),v={light:{soft:"grey",apply:"green",discard:"red",primary:"black",background:"white",white:"white",primaryButton:"grey",secondaryButton:"rgb(20,128,250)",disabled:"#d8d8d8",warning:"#E4D00A"}},w={default:"android"===r.a.OS?"Roboto":"Avenir",sizeDefault:18,sizeTitle:28,sizeHeader:24,sizeSmall:16,sizeVerySmall:13,sizeBig:20},z=n(2),S=n.n(z),P=n(19),k=n.n(P),T=n(71),C=n(1),D=["style"];function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var E=d.a.create({defaultFonts:{fontFamily:w.default,fontSize:w.sizeDefault}}),I=function(e){var t=e.style,n=k()(e,D);return Object(C.jsx)(T.a,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({style:[E.defaultFonts,t]},n))};var Q=d.a.create({button:{backgroundColor:v.light.primaryButton,borderRadius:10,justifyContent:"center",padding:10,alignItems:"center"},text:{color:v.light.white}}),N=function(e){var t=e.children,n=e.style,r=e.text,a=e.textStyle,i=e.onPress,o=void 0===i?function(){}:i;return Object(C.jsx)(O.a,{onPress:o,children:Object(C.jsxs)(j.a,{style:[Q.button,n],children:[t&&t,r&&Object(C.jsx)(I,{style:[Q.text,a],children:r})]})})},F=n(11),q=n.n(F),R=n(81),W=n.n(R),A=n(95),H=function(){var e;return q.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!document.cookie||!document.cookie.startsWith("hub=http://")&&!document.cookie.startsWith("hub=https://")){t.next=2;break}return t.abrupt("return",document.cookie.substring(4));case 2:return t.prev=2,t.next=5,q.a.awrap(W.a.get("/hubAddress.json"));case 5:return e=t.sent,t.abrupt("return",e.data.hub);case 9:return t.prev=9,t.t0=t.catch(2),t.abrupt("return","http://192.168.120.155:8080");case 12:case"end":return t.stop()}}),null,null,[[2,9]],Promise)},M="web"===r.a.OS?H():q.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,q.a.awrap(A.a.getItem("hubIp"));case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return","http://192.168.120.155:8080");case 9:case"end":return e.stop()}}),null,null,[[0,6]],Promise),U={get:function(e){var t,n;return q.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,q.a.awrap(M);case 2:return t=r.sent,r.next=5,q.a.awrap(W.a.get(t+e));case 5:return n=r.sent,r.abrupt("return",n);case 7:case"end":return r.stop()}}),null,null,null,Promise)},post:function(e,t){var n,r;return q.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,q.a.awrap(M);case 2:return n=a.sent,a.next=5,q.a.awrap(W.a.post(n+e,t));case 5:return r=a.sent,a.abrupt("return",r);case 7:case"end":return a.stop()}}),null,null,null,Promise)},put:function(e,t){var n,r;return q.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,q.a.awrap(M);case 2:return n=a.sent,a.next=5,q.a.awrap(W.a.put(n+e,t));case 5:return r=a.sent,a.abrupt("return",r);case 7:case"end":return a.stop()}}),null,null,null,Promise)},delete:function(e,t){var n,r;return q.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,q.a.awrap(M);case 2:return n=a.sent,a.next=5,q.a.awrap(W.a.delete(n+e,{data:t}));case 5:return r=a.sent,a.abrupt("return",r);case 7:case"end":return a.stop()}}),null,null,null,Promise)}};function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(c.useQueryClient)();return Object(c.useMutation)((function(e){return U.delete("/devices",e)}),V(V({},e),{},{onSuccess:function(){t.invalidateQueries(),e.onSuccess&&e.onSuccess()},onError:function(){alert("Nie uda\u0142o si\u0119 usun\u0105\u0107 urz\u0105dzenia!")}}))};var J=d.a.create({deviceCard:{width:"100%",borderRadius:8,borderWidth:1,borderColor:v.light.soft,padding:10,flexDirection:"row",backgroundColor:v.light.background},name:{fontSize:w.sizeBig},ip:{color:v.light.apply,fontSize:w.sizeSmall},leftSide:{flex:1},rightSide:{flexDirection:"row",alignItems:"center"},temp:{fontSize:w.sizeTitle},tempIcon:{marginBottom:-1,marginRight:5},notAlive:{opacity:.5,color:v.light.soft},delete:{backgroundColor:v.light.discard,height:"100%",padding:20,marginLeft:10},loadingVisible:{opacity:1},loadingNotVisible:{opacity:0}}),K=function(e){var t=e.device,n=Object(f.k)(),r=Object(p.useState)(!1),a=l()(r,2),i=a[0],o=a[1];Object(p.useEffect)((function(){i&&(n.navigate(B,t),o(!1))}),[i]);var c=Z(),s=t.ip,u=t.temp,b=t.alive,z=t.id,S=t.opened,P=t.name,k={},T={};b||(k=d.a.create({opacity:J.notAlive.opacity}),T=d.a.create({color:J.notAlive.color}));var D=Object(C.jsx)(j.a,{}),B="NewDevice";return P?(B="Device",D=Object(C.jsx)(N,{style:J.delete,onPress:function(){c.mutate(t)},children:Object(C.jsx)(g.a,{name:"trash",size:30,color:"white"})})):P=z,Object(C.jsx)(x.a,{children:Object(C.jsx)(m.a,{renderRightActions:function(){return D},children:Object(C.jsx)(O.a,{onPress:function(){o(!0)},children:Object(C.jsxs)(j.a,{style:[J.deviceCard,k],children:[Object(C.jsxs)(j.a,{style:J.leftSide,children:[Object(C.jsx)(I,{numberOfLines:1,style:J.name,children:P}),Object(C.jsx)(I,{style:[J.ip,T],children:b?s:"Nieaktywne"})]}),Object(C.jsxs)(j.a,{style:J.rightSide,children:[Object(C.jsx)(y.a,{color:v.light.primary,style:[J.loadingNotVisible,i&&J.loadingVisible]}),Object(C.jsx)(h.a,{color:S?v.light.discard:v.light.primary,size:w.sizeTitle,name:"thermometer-half",style:J.tempIcon}),Object(C.jsx)(I,{style:J.temp,children:u})]})]})})})})};var G=d.a.create({sperarator:{height:5}}),X=function(e){var t=e.devices;return Object(C.jsx)(b.a,{ItemSeparatorComponent:function(){return Object(C.jsx)(j.a,{style:G.sperarator})},data:t,keyExtractor:function(e){return e.id.toString()},renderItem:function(e){var t=e.item;return Object(C.jsx)(K,{device:t})}})},Y=n(259);var $=d.a.create({screen:{marginTop:Y.a.statusBarHeight,borderTopWidth:1,borderColor:v.light.soft,flex:1}}),_=function(e){var t=e.style,n=e.children;return Object(C.jsx)(j.a,{style:[$.screen,t],children:n})},ee=n(418),te=function(){var e,t;return q.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,q.a.awrap(U.get("/furnace"));case 2:return e=n.sent,t=e.data,n.abrupt("return",t);case 5:case"end":return n.stop()}}),null,null,null,Promise)},ne=function(){return Object(c.useQuery)("furnace",te,{refetchInterval:5e3})};var re=d.a.create({button:{width:52,backgroundColor:"rgba(0,0,0,0)"}}),ae=function(){var e=ne(),t=e.data,n="";return e.isSuccess&&(t.alive?t.on&&(n="fire"):n="exclamation-triangle"),Object(C.jsx)(N,{style:re.button,children:!!n&&Object(C.jsx)(g.a,{name:n,size:32})})},ie=function(){var e,t;return q.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,q.a.awrap(U.get("/time"));case 2:return e=n.sent,t=e.data,n.abrupt("return",t);case 5:case"end":return n.stop()}}),null,null,null,Promise)},oe=function(){return Object(c.useQuery)("time",ie,{refetchInterval:5e3})};var ce=d.a.create({systemTime:{alignItems:"center",justifyContent:"center"},texts:{fontSize:w.sizeSmall}}),se=function(){var e=oe(),t=e.data,n=e.isSuccess;return Object(C.jsx)(j.a,{style:ce.systemTime,children:n?Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(I,{style:ce.texts,children:["Niedziela","Poniedzia\u0142ek","Wtorek","\u015aroda","Czwartek","Pi\u0105tek","Sobota"][t.dayOfWeek]}),Object(C.jsx)(I,{style:ce.texts,children:t.time})]}):Object(C.jsx)(y.a,{color:v.light.primary})})};var ue=d.a.create({topBar:{flexDirection:"row",justifyContent:"space-between"}}),le=function(){var e=Object(f.k)();return Object(C.jsxs)(j.a,{style:ue.topBar,children:[Object(C.jsx)(ae,{}),Object(C.jsx)(se,{}),Object(C.jsx)(N,{children:Object(C.jsx)(ee.a,{name:"settings",onPress:function(){e.navigate("Settings")},size:32,color:"white"})})]})},de=function(){var e,t;return q.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,q.a.awrap(U.get("/newDevices"));case 2:return e=n.sent,t=e.data,n.abrupt("return",t);case 5:case"end":return n.stop()}}),null,null,null,Promise)},be=function(){return Object(c.useQuery)("newDevices",de,{refetchInterval:5e3})},je=function(){var e,t;return q.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,q.a.awrap(U.get("/devices"));case 2:return e=n.sent,t=e.data,n.abrupt("return",t);case 5:case"end":return n.stop()}}),null,null,null,Promise)},pe=function(){return Object(c.useQuery)("devices",je,{refetchInterval:5e3})},fe=function(){var e,t,n,r,a;return q.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,q.a.awrap(U.get("/mqttconnected"));case 2:return e=i.sent,t=e.data,i.next=6,q.a.awrap(U.get("/options/set"));case 6:return n=i.sent,r=n.data,a={mqttConnected:t,optionsSetByUser:r},i.abrupt("return",a);case 10:case"end":return i.stop()}}),null,null,null,Promise)},Oe=function(){return Object(c.useQuery)("otherThings",fe,{refetchInterval:6e4})};var ye=d.a.create({texts:{fontSize:w.sizeHeader,marginBottom:10,marginTop:10},container:{paddingLeft:10,paddingRight:10},topMargin:{height:10},margins:{marginTop:10},configureHub:{backgroundColor:v.light.warning},connectionIssue:{backgroundColor:v.light.discard}}),ge=function(){var e=Object(f.k)(),t=Object(p.useState)({devices:null,newDevices:null}),n=l()(t,2),r=n[0],a=n[1],i=Object(c.useQueryClient)(),o=be(),s=o.data,u=o.isLoading,d=o.isSuccess,O=o.dataUpdatedAt,y=pe(),g=y.data,h=y.isLoading,m=y.isSuccess,x=y.dataUpdatedAt,v=Oe(),w=v.data,z=v.isError,S=v.isSuccess,P=[{id:"1",content:Object(C.jsx)(j.a,{style:ye.topMargin})},{id:"5",content:Object(C.jsx)(le,{})},{id:"6",content:Object(C.jsx)(C.Fragment,{children:z&&Object(C.jsx)(N,{style:[ye.margins,ye.connectionIssue],text:"Brak po\u0142\u0105czenia z HUBem!",onPress:function(){e.navigate("Settings")}})})},{id:"7",content:Object(C.jsx)(C.Fragment,{children:S&&!w.optionsSetByUser&&Object(C.jsx)(N,{style:[ye.margins,ye.configureHub],text:"Przeprowad\u017a wst\u0119pn\u0105 konfiguracj\u0119 huba!",onPress:function(){e.navigate("Settings")}})})},{id:"8",content:Object(C.jsx)(C.Fragment,{children:S&&!w.mqttConnected&&Object(C.jsx)(N,{style:[ye.margins,ye.connectionIssue],onPress:function(){e.navigate("Settings")},text:"Brak po\u0142\u0105czenia z broakerem MQTT!"})})},{id:"10",content:Object(C.jsx)(I,{style:ye.texts,children:"Pokoje:"})},{id:"20",content:h?Object(C.jsx)(I,{children:"\u0141adowanie urz\u0105dze\u0144..."}):m?g&&g.length?Object(C.jsx)(X,{devices:g}):Object(C.jsx)(I,{children:"\u017badne urz\u0105dzenie nie zosta\u0142o skonfigurowane w systemie!"}):Object(C.jsx)(I,{children:"B\u0142\u0105d podczas \u0142adowania urz\u0105dze\u0144!"})},{id:"30",content:Object(C.jsx)(I,{style:ye.texts,children:"Urz\u0105dzenia oczekuj\u0105ce na parowanie:"})},{id:"40",content:u?Object(C.jsx)(I,{children:"\u0141adowanie urz\u0105dze\u0144..."}):d?s&&s.length?Object(C.jsx)(X,{devices:s}):Object(C.jsx)(I,{children:"\u017badne urz\u0105dzenie nie zosta\u0142o skonfigurowane w systemie!"}):Object(C.jsx)(I,{children:"B\u0142\u0105d podczas \u0142adowania urz\u0105dze\u0144!"})}];return Object(C.jsx)(_,{children:Object(C.jsx)(b.a,{refreshing:O===r.devices||x===r.newDevices,onRefresh:function(){a({devices:O,newDevices:x}),i.invalidateQueries()},style:ye.container,data:P,keyExtractor:function(e){return e.id.toString()},renderItem:function(e){return e.item.content}})})},he=n(142),me=n(422),xe=n(57),ve=n(141);var we=d.a.create({screen:{flex:1},safeBottomSpace:{height:30}}),ze=function(e){var t=e.style,n=e.children;return Object(C.jsxs)(xe.a,{style:[we.screen,t],children:[n,Object(C.jsx)(ve.a,{})]})},Se=n(88),Pe=["label","style","labelStyle","disabled"];function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ce=d.a.create({border:{},input:{borderWidth:1,borderRadius:5,padding:5,fontFamily:w.default,fontSize:w.sizeDefault,borderColor:v.light.soft},container:{flex:1},disabledColor:{backgroundColor:v.light.disabled}}),De=function(e){var t=e.label,n=e.style,r=e.labelStyle,a=e.disabled,i=void 0!==a&&a,o=k()(e,Pe),c={};return i&&(c=Ce.disabledColor),Object(C.jsxs)(j.a,{style:[Ce.container,n],children:[t&&Object(C.jsx)(I,{style:r,children:t}),Object(C.jsx)(Se.a,Te({editable:!i,selectTextOnFocus:!i,style:[Ce.input,c]},o))]})},Be=n(258),Ee=n(164),Ie=n(163),Qe=["label","style","updateTime","value","disabled"];function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qe=d.a.create({container:{flex:1},input:{textAlign:"center"},inputContainer:{borderWidth:1,borderRadius:5,borderColor:v.light.soft,padding:5},disabledColor:{backgroundColor:v.light.disabled},buttonGroup:{flexDirection:"row",justifyContent:"center",borderTopWidth:1,borderColor:v.light.soft,justifyContent:"space-evenly",padding:10},modal:{flexDirection:"row",flex:1,justifyContent:"center"},modalContent:{backgroundColor:v.light.background,alignSelf:"flex-end",marginBottom:10,flex:1,borderRadius:30,marginLeft:15,marginRight:15,borderWidth:1,borderColor:v.light.soft}}),Re=function(e){var t=e.label,n=e.style,a=e.updateTime,i=void 0===a?function(){}:a,o=e.value,c=e.disabled,s=void 0!==c&&c,u=k()(e,Qe),d=Object(p.useState)(!1),b=l()(d,2),f=b[0],y=b[1],g=Object(p.useState)(),h=l()(g,2),m=h[0],x=h[1],z="number"===typeof o;if(z){1===(o=o.toString()).length&&(o="000"+o);var S=o.length;o=o.substring(0,S-2)+":"+o.substring(S-2),2===S&&(o="00"+o),3===S&&(o="0"+o)}var P=new Date("2000-01-01T"+o),T=function(e,t){if(y(!1),"set"===e.type){var n=t.toTimeString().split(" ")[0].substring(0,5);z&&(n=parseInt(n.replace(":",""))),i(n)}},D={};return s&&(D=qe.disabledColor),Object(C.jsxs)(j.a,{style:[qe.container,n],children:[t&&Object(C.jsx)(I,{children:t}),"web"===r.a.OS?Object(C.jsx)("input",{style:{height:2*w.sizeDefault,width:"95%",fontSize:w.sizeDefault,fontFamily:w.default,backgroundColor:s?v.light.disabled:v.light.background,borderRadius:5,borderWidth:1,textAlign:"center",alignSelf:"center"},type:"time",disabled:s,value:m||o,onChange:function(e){var t=e.target;x(t.value)},onBlur:function(){T({type:"set"},new Date("2000-01-01T"+m)),x()}}):Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(O.a,{onPress:function(){y(!0),"ios"===r.a.OS&&x(P)},children:Object(C.jsx)(j.a,{style:[qe.inputContainer,D],children:Object(C.jsx)(I,Fe(Fe({style:qe.input},u),{},{children:o}))})}),!s&&("android"===r.a.OS?f&&Object(C.jsx)(Ie.a,{onChange:T,mode:"time",value:P}):Object(C.jsx)(Be.a,{transparent:!0,visible:f,animationType:"slide",children:Object(C.jsx)(ve.a,{style:qe.modal,children:Object(C.jsxs)(j.a,{style:qe.modalContent,children:[Object(C.jsx)(Ie.a,{onChange:function(e,t){x(t)},mode:"time",value:m,display:"spinner",themeVariant:"light"}),Object(C.jsxs)(j.a,{style:qe.buttonGroup,children:[Object(C.jsx)(Ee.a,{title:"Zamknij",onPress:function(){y(!1)}}),Object(C.jsx)(Ee.a,{title:"Zatwierd\u017a",onPress:function(){T({type:"set"},m)}})]})]})})}))]})]})},We=n(137),Ae=["label","style","value","onChange"];function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ue="android"===r.a.OS,Le=d.a.create({border:{},input:{borderWidth:1,borderRadius:5,padding:5,fontFamily:w.default,borderColor:v.light.soft},label:{marginLeft:"android"===r.a.OS?0:5},container:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"android"===r.a.OS?"space-between":"flex-start"}}),Ve=function(e){var t=e.label,n=e.style,r=e.value,a=e.onChange,i=k()(e,Ae);return Object(C.jsxs)(j.a,{style:[Le.container,n],children:[t&&Ue&&Object(C.jsxs)(I,{style:Le.label,value:r,children:[t,":"]}),Object(C.jsx)(We.a,Me({onValueChange:a,value:r},i)),t&&!Ue&&Object(C.jsxs)(I,{style:Le.label,value:r,children:[t,"."]})]})},Ze=function(){var e,t;return q.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,q.a.awrap(U.get("/options"));case 2:return e=n.sent,t=e.data,n.abrupt("return",t);case 5:case"end":return n.stop()}}),null,null,null,Promise)},Je=function(){return Object(c.useQuery)("settings",Ze,{refetchInterval:!1})};function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(c.useQueryClient)();return Object(c.useMutation)((function(e){return U.put("/options",e)}),Ge(Ge({},e),{},{onSuccess:function(n){var r=n.data;t.invalidateQueries(),e.onSuccess&&e.onSuccess(r)},onError:function(){alert("Nie uda\u0142o si\u0119 zmodyfikowa\u0107 ustawie\u0144! Sprawd\u017a czy pola zosta\u0142y wype\u0142nione poprawnie!")}}))},Ye=function(){var e;return q.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("web"!==r.a.OS){t.next=6;break}return t.next=3,q.a.awrap(H());case 3:t.t0=t.sent,t.next=9;break;case 6:return t.next=8,q.a.awrap(A.a.getItem("hubIp"));case 8:t.t0=t.sent;case 9:if(!(e=t.t0)){t.next=12;break}return t.abrupt("return",e);case 12:return t.abrupt("return","http://");case 13:case"end":return t.stop()}}),null,null,null,Promise)},$e=function(){return Object(c.useQuery)("hubIp",Ye,{refetchInterval:!1})},_e=function(e){return Object(c.useMutation)((function(e){return"web"===r.a.OS?function(e){return document.cookie="hub="+e,!0}(e):A.a.setItem("hubIp",e)}),{onSuccess:e.onSuccess})};function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var nt=d.a.create({title:{fontSize:w.sizeTitle},databaseHeader:{marginTop:20,fontSize:w.sizeHeader},dayBeginEnd:{flexDirection:"row",justifyContent:"space-between"},dayBegin:{marginRight:5},dayEnd:{marginLeft:5},container:{paddingLeft:10,paddingRight:10},submit:{backgroundColor:v.light.apply,marginTop:10,marginBottom:10}}),rt=function(){var e=Object(p.useState)(!1),t=l()(e,2),n=t[0],a=t[1],i=Object(f.k)(),o=Je(),c=o.data,s=o.isSuccess,u=o.isFetching,d=o.isError,b=$e(),O=b.data,y=b.isFetching,g=b.isSuccess,h=_e({onSuccess:function(){"web"===r.a.OS?location.reload():me.a()}}),m=Object(p.useState)(O),x=l()(m,2),v=x[0],w=x[1],z=Object(p.useState)(s?c:{day:"08:00",night:"22:00",hysteresis:.2,mqttaddress:"mqtt://127.0.0.1:1883",mqtttopic:"NamNoc",mqttuser:"",mqttpassword:"",mqttfurnacetopic:"furnace",usedb:!1,influxdb:{url:"",organisation:"",bucket:"",key:""}}),S=l()(z,2),P=S[0],k=S[1],T=Xe({onSuccess:function(e){k(e),he.a.alert("Sukces!","Czy chcesz pozosta\u0107 na ekranie ustawie\u0144?",[{text:"Tak"},{text:"Nie",onPress:function(){i.goBack()}}])}});Object(p.useEffect)((function(){s&&k(c)}),[c]),Object(p.useEffect)((function(){g&&w(O)}),[O]);var D=function(e,t){var n=tt({},P);n[e]=t,k(n)},B=function(e,t){var n=tt({},P);n.influxdb[e]=t,k(n)},E=u||d;return Object(C.jsx)(ze,{children:Object(C.jsxs)(j.a,{style:nt.container,children:[Object(C.jsx)(I,{style:nt.title,children:"Ustawienia"}),Object(C.jsx)(De,{keyboardType:"url",autoCapitalize:"none",disabled:y,value:v,onChangeText:function(e){w(e),a(!0)},label:"Adres huba:"}),s&&!n&&Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)(De,{onChangeText:function(e){D("mqttaddress",e)},keyboardType:"url",autoCapitalize:"none",value:P.mqttaddress,disabled:E,label:"Adres brokera MQTT:"}),Object(C.jsx)(De,{onChangeText:function(e){D("mqtttopic",e)},keyboardType:"email-address",autoCapitalize:"none",value:P.mqtttopic,disabled:E,label:"Temat MQTT huba:"}),Object(C.jsx)(De,{onChangeText:function(e){D("mqttfurnacetopic",e)},keyboardType:"email-address",autoCapitalize:"none",value:P.mqttfurnacetopic,disabled:E,label:"Temat MQTT pieca:"}),Object(C.jsx)(De,{onChangeText:function(e){D("mqttuser",e)},keyboardType:"email-address",autoCapitalize:"none",value:P.mqttuser,disabled:E,label:"U\u017cytkownik MQTT:"}),Object(C.jsx)(De,{onChangeText:function(e){D("mqttpassword",e)},value:P.mqttpassword,disabled:E,secureTextEntry:!0,label:"Has\u0142o MQTT:"}),Object(C.jsx)(De,{value:P.hysteresis.toString(),onChangeText:function(e){D("hysteresis",e)},disabled:E,keyboardType:"numeric",label:"Histereza :"}),Object(C.jsxs)(j.a,{style:nt.dayBeginEnd,children:[Object(C.jsx)(Re,{disabled:E,value:P.day,style:nt.dayBegin,label:"Pocz\u0105tek dnia:",updateTime:function(e){D("day",e)}}),Object(C.jsx)(Re,{disabled:E,value:P.night,style:nt.dayEnd,label:"Koniec dnia:",updateTime:function(e){D("night",e)}})]}),Object(C.jsx)(I,{style:nt.databaseHeader,children:"Ustawienia influxDB:"}),Object(C.jsx)(Ve,{disabled:E,value:P.usedb,onChange:function(){!function(){var e=tt({},P);e.usedb=!e.usedb,k(e)}()},label:"U\u017cywaj bazy danych"}),Object(C.jsx)(De,{onChangeText:function(e){B("url",e)},value:P.influxdb.url,disabled:!P.usedb,keyboardType:"url",autoCapitalize:"none",label:"Adres bazy danych:"}),Object(C.jsx)(De,{onChangeText:function(e){B("organisation",e)},value:P.influxdb.organisation,disabled:!P.usedb,label:"Nazwa organizacji:",keyboardType:"email-address",autoCapitalize:"none"}),Object(C.jsx)(De,{onChangeText:function(e){B("bucket",e)},value:P.influxdb.bucket,disabled:!P.usedb,label:"Nazwa Koszyka:",keyboardType:"email-address",autoCapitalize:"none"}),Object(C.jsx)(De,{onChangeText:function(e){B("key",e)},value:P.influxdb.key,secureTextEntry:!0,disabled:!P.usedb,label:"Token autoryzacji:"})]}),Object(C.jsx)(N,{onPress:function(){return n?h.mutate(v):s?T.mutate(P):void i.goBack()},text:"Zapisz ustawienia",style:nt.submit})]})})},at=n(17),it=n.n(at),ot=[["monday","Poniedzia\u0142ek","poniedzia\u0142ku"],["tuesday","Wtorek","wtorku"],["wednesday","\u015aroda","\u015brody"],["thursday","Czwartek","czwartku"],["friday","Pi\u0105tek","pi\u0105tku"],["saturday","Sobota","soboty"],["sunday","Niedziela","niedzieli"]];var ct=d.a.create({copyFromButtons:{flexDirection:"row",flexWrap:"wrap"},copyFromButton:{margin:2,backgroundColor:v.light.secondaryButton},copyFromButtonText:{fontSize:w.sizeVerySmall},timePeriods:{flexDirection:"row",justifyContent:"space-evenly",alignItems:"center"},divideDeleteText:{fontSize:w.sizeVerySmall},divideDelete:{marginLeft:5},delete:{backgroundColor:v.light.discard},lastDelete:{opacity:.5},verySmallTexts:{fontSize:w.sizeVerySmall},periodTexts:{fontSize:w.sizeSmall},dayOfWeek:{borderColor:v.light.soft,borderWidth:1,borderRadius:10,padding:5,marginTop:5}}),st=function(e){var t=e.schedule,n=e.updateSchedule,r=function(e,r){var a=!1;if(0===t[e].times.length)t[e].times=[{end:1200,temp:t[e].lastTemp}],a=!0;else{var i=0,o={end:2359,temp:t[e].lastTemp};r>0&&(i=t[e].times[r-1].end);var c=i%100,s=(i-c)/100;r!==t[e].times.length&&(o=t[e].times[r]);var u=o.end%100,l=(o.end-u)/100,d=Math.round((60*s+c+(60*l+u))/2),b=d%60,j=(d-b)/60*100+b;if(j<o.end){var p=[].concat(it()(t[e].times.slice(0,r)),[{end:j,temp:o.temp}],it()(t[e].times.slice(r)));t[e].times=p,a=!0}}a?n(t):alert("Przedzia\u0142 nie mo\u017ce by\u0107 kr\xf3tszy ni\u017c minuta!")},a=Object(C.jsx)(Re,{disabled:!0,value:"00:00"});return Object(C.jsx)(j.a,{children:ot.map((function(e){return Object(C.jsxs)(j.a,{style:ct.dayOfWeek,children:[Object(C.jsx)(I,{children:e[1]}),Object(C.jsx)(I,{style:ct.verySmallTexts,children:"Kopiuj z:"}),Object(C.jsx)(j.a,{style:ct.copyFromButtons,children:ot.map((function(r){return Object(C.jsx)(N,{onPress:function(){!function(e,r){var a=JSON.parse(JSON.stringify(t[e]));t[r]=a,n(t)}(r[0],e[0])},text:r[2],style:ct.copyFromButton,textStyle:ct.copyFromButtonText},r[0])}))}),Object(C.jsx)(I,{style:ct.periodTexts,children:"Przedzia\u0142 1"}),t[e[0]].times.map((function(i,o){return Object(C.jsxs)(j.a,{children:[Object(C.jsxs)(j.a,{style:ct.timePeriods,children:[a,Object(C.jsx)(I,{children:" \u2013 "}),a=Object(C.jsx)(Re,{value:i.end,updateTime:function(r){!function(e,r,a){var i=2359,o=0;t[e].times.length!==r+1&&(i=t[e].times[r+1].end),0!==r&&(o=t[e].times[r-1].end),i>a&&o<a?(t[e].times[r].end=a,n(t)):alert("Nieprawid\u0142owe granice przedzia\u0142u! Upewnij si\u0119, czy pocz\u0105tek przedzia\u0142u jest mniejszy od ko\u0144ca przedzia\u0142u, czy koniec tego przedzia\u0142u jest mniejszy od ko\u0144ca kolejnego przedzia\u0142u, oraz czy pocz\u0105tek tego przedzia\u0142u jest wi\u0119kszy pocz\u0105tku poprzedniego!")}(e[0],o,r)}}),Object(C.jsx)(N,{onPress:function(){r(e[0],o)},text:"Podziel",textStyle:ct.divideDeleteText,style:ct.divideDelete}),Object(C.jsx)(N,{textStyle:ct.divideDeleteText,style:[ct.divideDelete,ct.delete],name:e[0],onPress:function(){!function(e,r){t[e].times.splice(r,1),n(t)}(e[0],o)},text:"Usu\u0144"})]}),Object(C.jsx)(De,{label:"Temperatura:",labelStyle:ct.verySmallTexts,keyboardType:"numeric",value:i.temp.toString(),onChangeText:function(r){!function(e,r,a){t[e].times[r].temp=a,n(t)}(e[0],o,r)}}),Object(C.jsxs)(I,{style:ct.periodTexts,children:["Przedzia\u0142 ",o+2]})]},i.end)})),Object(C.jsxs)(j.a,{style:ct.timePeriods,children:[a,Object(C.jsx)(I,{children:" \u2013 "}),Object(C.jsx)(Re,{disabled:!0,value:"23:59"}),Object(C.jsx)(N,{name:e[0],onPress:function(){r(e[0],t[e[0]].times.length)},text:"Podziel",textStyle:ct.divideDeleteText,style:ct.divideDelete}),Object(C.jsx)(N,{textStyle:ct.divideDeleteText,style:[ct.divideDelete,ct.delete,ct.lastDelete],name:e[0],onPress:function(){alert("Nie mo\u017cna usuwa\u0107 ostatniego przedzia\u0142u!")},text:"Usu\u0144"})]}),Object(C.jsx)(De,{label:"Temperatura:",labelStyle:ct.verySmallTexts,keyboardType:"numeric",value:t[e[0]].lastTemp.toString(),onChangeText:function(r){return function(e,r){t[e].lastTemp=r,n(t)}(e[0],r)}}),void(a=Object(C.jsx)(Re,{disabled:!0,value:"00:00"}))]},e[0])}))})};function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(c.useQueryClient)();return Object(c.useMutation)((function(e){return U.put("/devices",e)}),lt(lt({},e),{},{onSuccess:function(n){var r=n.data;t.invalidateQueries(),e.onSuccess&&e.onSuccess(r)},onError:function(){alert("Nie uda\u0142o si\u0119 zmodyfikowa\u0107 urz\u0105dzenia! Sprawd\u017a czy pola zosta\u0142y wype\u0142nione poprawnie!")}}))};function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pt=d.a.create({title:{fontSize:w.sizeTitle,textAlign:"justify"},header:{marginTop:10,fontSize:w.sizeHeader},harmonogram:{fontSize:w.sizeBig},container:{paddingLeft:10,paddingRight:10},submit:{backgroundColor:v.light.apply,marginTop:10,marginBottom:10},delete:{backgroundColor:v.light.discard,marginTop:10,marginBottom:10}}),ft=function(e){var t=e.route,n=Object(p.useState)(t.params),a=l()(n,2),i=a[0],o=a[1],c=Object(p.useState)(jt({},i).name),s=l()(c,1)[0],u=dt({onSuccess:function(e){"web"===r.a.OS?d.goBack():he.a.alert("Sukces!","Czy chcesz pozosta\u0107 na ekranie konfiguracji urz\u0105dzenia "+e.name+"?",[{text:"Tak",onPress:function(){o(e)}},{text:"Nie",onPress:function(){d.goBack()}}])}}),d=Object(f.k)(),b=Z({onSuccess:function(){d.goBack()}}),O=i.name,y=i.schedule;return Object(C.jsx)(ze,{children:Object(C.jsxs)(j.a,{style:pt.container,children:[Object(C.jsx)(I,{style:pt.title,children:s}),Object(C.jsx)(N,{text:"Usu\u0144 z systemu",onPress:function(){b.mutate(i)},style:pt.delete}),Object(C.jsx)(I,{style:pt.header,children:"Zmiana ustawie\u0144"}),Object(C.jsx)(De,{label:"Nazwa pomieszczenia:",onChangeText:function(e){var t=jt({},i);t.name=e,o(t)},value:O}),Object(C.jsx)(I,{style:pt.harmonogram,children:"Harmonogram:"}),Object(C.jsx)(st,{schedule:y,updateSchedule:function(e){var t=jt({},i);t.schedule=e,o(t)}}),Object(C.jsx)(N,{text:"Zapisz ustawienia",onPress:function(){u.mutate(i)},style:pt.submit})]})})};function Ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(c.useQueryClient)();return Object(c.useMutation)((function(e){return U.post("/devices",e)}),yt(yt({},e),{},{onSuccess:function(){t.invalidateQueries(),e.onSuccess&&e.onSuccess()},onError:function(){alert("Nie uda\u0142o si\u0119 doda\u0107 urz\u0105dzenia! Sprawd\u017a czy pola zosta\u0142y wype\u0142nione poprawnie!")}}))};function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xt=d.a.create({title:{fontSize:w.sizeTitle},header:{marginTop:10,fontSize:w.sizeHeader},harmonogram:{fontSize:w.sizeBig},container:{paddingLeft:10,paddingRight:10},submit:{backgroundColor:v.light.apply,marginTop:10,marginBottom:10},id:{fontSize:w.sizeVerySmall}}),vt=function(e){var t=e.route,n=Object(f.k)(),r=(Object(c.useQueryClient)(),gt({onSuccess:function(){n.goBack()}})),a=Object(p.useState)({monday:{times:[],lastTemp:20},tuesday:{times:[],lastTemp:20},wednesday:{times:[],lastTemp:20},thursday:{times:[],lastTemp:20},friday:{times:[],lastTemp:20},saturday:{times:[],lastTemp:20},sunday:{times:[],lastTemp:20}}),i=l()(a,2),o=i[0],s=i[1],u=Object(p.useState)(""),d=l()(u,2),b=d[0],O=d[1],y=t.params.id;return Object(C.jsx)(ze,{children:Object(C.jsxs)(j.a,{style:xt.container,children:[Object(C.jsxs)(j.a,{children:[Object(C.jsx)(I,{style:xt.title,children:"Nowe urz\u0105dzenie"}),Object(C.jsx)(I,{style:xt.id,children:y})]}),Object(C.jsx)(I,{style:xt.header,children:"Konfiguracja urz\u0105dzenia"}),Object(C.jsx)(De,{label:"Nazwa pomieszczenia:",onChangeText:function(e){return O(e)}}),Object(C.jsx)(I,{style:xt.harmonogram,children:"Harmonogram:"}),Object(C.jsx)(st,{schedule:o,updateSchedule:function(e){s(mt({},e))}}),Object(C.jsx)(N,{text:"Dodaj do systemu",onPress:function(){var e=mt({name:b,schedule:o},t.params);r.mutate(e)},style:xt.submit})]})})},wt=n(143);function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function St(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pt=St(St({},wt.a),{},{colors:St(St({},wt.a.colors),{},{background:v.light.background})});s.a.ignoreLogs(["Setting a timer for a long period of time"]);var kt=Object(i.a)(),Tt=new c.QueryClient,Ct=function(){return Object(C.jsxs)(kt.Navigator,{children:[Object(C.jsx)(kt.Screen,{name:"Main",options:{headerShown:!1,title:"Ekran g\u0142\xf3wny"},component:ge}),Object(C.jsx)(kt.Screen,{name:"Settings",options:{title:""},component:rt}),Object(C.jsx)(kt.Screen,{name:"Device",options:{title:""},component:ft}),Object(C.jsx)(kt.Screen,{name:"NewDevice",options:{title:""},component:vt})]})};function Dt(){return Object(C.jsxs)(C.Fragment,{children:["ios"===r.a.OS&&Object(C.jsx)(a.a,{barStyle:"dark-content",translucent:!0}),Object(C.jsx)(o.a,{theme:Pt,children:Object(C.jsx)(c.QueryClientProvider,{client:Tt,children:Object(C.jsx)(Ct,{})})})]})}},270:function(e,t,n){e.exports=n(407)}},[[270,1,2]]]);
//# sourceMappingURL=app.2e59e911.chunk.js.map